"use strict";const resultsList=document.querySelector(".js-results-list"),inputAnime=document.querySelector(".js-input"),btnSearch=document.querySelector(".js-btn-search"),favoriteList=document.querySelector(".js-favorite-list");let dataAnimes=[],favoritesAnimes=[];loadAnimesLocalStorage();const handleClickSearch=e=>{e.preventDefault(),getDataApi(inputAnime.value.toLowerCase())};function listenerAnimes(){const e=document.querySelectorAll(".js-list-anime");for(const i of e)i.addEventListener("click",handleClickAnime)}function handleClickAnime(e){const i=parseInt(e.currentTarget.id),t=dataAnimes.find(e=>e.mal_id===i),a=favoritesAnimes.findIndex(e=>e.mal_id===i);-1===a?favoritesAnimes.push(t):favoritesAnimes.splice(a,1),localStorage.setItem("favorites_anime",JSON.stringify(favoritesAnimes)),renderAnime(),renderFavoriteAnime()}function renderAnime(){let e="",i="";for(const t of dataAnimes){let a=animeImage(t);i=-1!==favoritesAnimes.findIndex(e=>t.mal_id===e.mal_id)?"favorite-click":"",e+=` <li class="js-list-anime anime__results-list ${i}" id="${t.mal_id}">`,e+=' <div class="js-container-anime">',e+=` <h3 class="anime__results-list-title">${t.title}</h3>`,e+=` <img class="anime_img" src="${a}" alt="Portada de la serie de anime ${t.title}" title="Portada de la serie de anime ${t.title}"/>`,e+="</div></li>"}resultsList.innerHTML=e,listenerAnimes()}function animeImage(e){return"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===e.images.jpg.image_url?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":e.images.jpg.image_url}function renderFavoriteAnime(){let e=JSON.parse(localStorage.getItem("favorites_anime")),i="";for(const t of e){let e=animeImage(t);i+=` <li class=" anime__favorite-list  id="${t.mal_id}">`,i+=' <div class="js-container-anime">',i+=` <div><h3 class="anime__favorite-list-title">${t.title}</h3>`,i+='<i class="fa-solid fa-trash-xmark"></i></div>',i+=` <img class="anime_img" src="${e}" alt="Portada de la serie de anime ${t.title}" title="Portada de la serie de anime ${t.title}"/>`,i+="</div></li>"}favoriteList.innerHTML=i}function loadAnimesLocalStorage(){favoritesAnimes=JSON.parse(localStorage.getItem("favorites_anime")),Array.isArray(favoritesAnimes)||(favoritesAnimes=[])}function getDataApi(e){fetch("https://api.jikan.moe/v4/anime?q="+e).then(e=>e.json()).then(e=>{dataAnimes=e.data,renderAnime()})}btnSearch.addEventListener("click",handleClickSearch),renderFavoriteAnime();const btnReset=document.querySelector(".js-btn-reset");function handleClickReset(e){e.preventDefault(),inputAnime.value="",resultsList.innerHTML="",favoriteList.innerHTML="",localStorage.removeItem("favorites_anime")}btnReset.addEventListener("click",handleClickReset);